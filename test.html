<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <link href="https://vjs.zencdn.net/8.3.0/video-js.css" rel="stylesheet" />
  <title>Document</title>
</head>

<body>
  <script src="https://unpkg.com/video.js/dist/video.min.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Roboto+Slab" rel="stylesheet">



  <!-- <video
    id="my-video"
    class="video-js"
   controls
    preload="auto"
     width="640"
     height="264"

     data-setup="{}"
  >
     <source src="https://origin2-6play.live.6cloud.fr/pool_rnpls9by/gulli/sixplaysd/hls_short_q2hyb21h_gulli/index.m3u8"  type="application/x-mpegURL">

    

        
        
    
     <p class="vjs-no-js">
      To view this video please enable JavaScript, and consider upgrading to a
     web browser that
       <a href="https://videojs.com/html5-video-support/" target="_blank"
         >supports HTML5 video</a
      >
     </p>
   </video> -->



  <div class="tab-content">
    <div id="home2" data-tab-content class="active">
      <h1>Direct</h1>
      <p>This is the home</p>
      <p>Number of channel: <span id="episodes"></span></p>




      <div class="all">
        <div id="monlecteur" class="lecteur">


          <h3 id="titretv"></h3>
          <p id="demo">

            <video id="my-video" class="video-js" controls preload="auto" vjs-16-9 data-setup="{}" src="
                https://vjs.zencdn.net/v/oceans.mp4">



            </video>

          <div class="mesboutons">
            <button id="fullplayser" class="grandecran">Passer en plein écran</button>
            <button id="pauseplayser" class="grandecran">Pause</button>
            <button id="playplayser" class="grandecran">Play</button>
            <button id="closeplayser" class="grandecran">Fermer</button>
            <button id="randomplayser" class="grandecran">Random</button>

          </div>


        </div>



        <div id="maliste" class="liste">


        </div>
      </div>







      </p>
    </div>

    <div id="enfant" data-tab-content>
      <h1>Enfants</h1>
      <p>Some information on pricing</p>
    </div>

    <div id="cinema" data-tab-content>
      <h1>Cinéma</h1>
      <p>Let me tell you about me</p>
    </div>

    <div id="news" data-tab-content>
      <h1>News</h1>
      <p>News is great.</p>
    </div>


    <ul class="tabs">
      <li data-tab-target="#home2" class="active tab">Direct</li>
      <li data-tab-target="#enfant" class="tab">Enfant</li>
      <li data-tab-target="#cinema" class="tab">Cinema</li>
      <li data-tab-target="#news" class="tab">News</li>
    </ul>

  </div>



  <script>

    class TV {
      constructor(title, channel, color, url) {
        this.title = title;
        this.channel = channel;
        this.color = color;
        this.url = url;
      }
    }

    let firstEpisode = new TV('Gulli', 18, "enfant", 'https://origin2-6play.live.6cloud.fr/pool_rnpls9by/gulli/sixplaysd/hls_short_q2hyb21h_gulli/index.m3u8');
    let secondEpisode = new TV('supertoons', 450, "enfant", 'https://kedoo-supertoonstv-3-fr.samsung.wurl.tv/playlist.m3u8');
  let france3  = new TV('France3', 450, "fr3", 'http://mag.you24.online:80/Adilzborci/i5x4yi4klk/682959');
    let thirdEpisode = new TV('W9', 60, "w9", 'https://origin-fra14-ed.pzaz.tv/live/w9/playlist.m3u8');
    let quaytre = new TV('Tf1', 45, "tf1", 'https://origin-fra14-ed.pzaz.tv/live/tf1/playlist.m3u8');
    let cinq = new TV('Canal +', 45, "canal", 'http://hls-m007.live-lv3.canalplus-cdn.net/live/disk/canalplusclair-hd/hls-ios-fhd-clair/canalplusclair-hd.m3u8');
    let six = new TV('Arte', 60, "arte", 'https://artesimulcast.akamaized.net/hls/live/2031003/artelive_fr/index.m3u8');
    let sept = new TV('Tmc', 60, "color1", 'https://origin-fra14-ed.pzaz.tv/live/tmc/playlist.m3u8');
    let huit = new TV('cherie25', 60, "color2", 'https://cherie25.nrjaudio.fm/hls/live/2038375/c25/FHD.m3u8');
    let neuf = new TV('Tmc', 60, "color1", 'https://www.dailymotion.com/video/x5gv5rr#tab_embed.m3u8');

    // Modify the array here
    // ====================================
    let episodes = [firstEpisode, secondEpisode, france3, thirdEpisode, quaytre, cinq, six, sept, huit, neuf]
    let numberOfEpisodes = episodes.length; // 6

    // ====================================

    const lecteur = document.querySelector('#monlecteur');
    const body = document.querySelector('#maliste');

    document.querySelector('#episodes').innerText = numberOfEpisodes;

    var box = document.createElement('div');
    box.classList.add('flex');


    randomplayser.addEventListener("click", function () {
      test();
    });


    var m3u = []


    episodes.forEach(element => {
      m3u.push(element.url)


    });







    for (let episode of episodes) {



      //random



      function test() {
        var myPlayer = videojs('#my-video');
        var monttre = document.querySelector("#titretv");







        myPlayer.autoplay(true);
        myPlayer.loop(true);
        myPlayer.fluid(true);
        var values = m3u
        var valueToUse = values[Math.floor(Math.random() * values.length)];


        let pos = m3u.indexOf(valueToUse);
        // let index = m3u.findIndex(element => element === valueToUse);
        console.table(episodes[pos].title); // 3
        monttre.innerText = episodes[pos].title
        // console.log(monttre)










        myPlayer.src(valueToUse);
        console.log(valueToUse)

      }







      let newDiv = document.createElement('div');
      newDiv.classList.add('series-frame');
      newDiv.setAttribute("class", `series-frame ${episode.color}`);


      // let myVideo = document.createElement('p')
      // myVideo.classList.add('infos');

      // myVideo.innerHTML = `  <video
      //     id="my-video"
      //     class="video-js"
      //     controls
      //     preload="auto"
      //     width="640"
      //     height="264"
      //     poster="MY_VIDEO_POSTER.jpg"
      //     data-setup="{}"
      //   >
      //     <source src="${episode.url}"  type="application/x-mpegURL">
      //     <source src="${episode.url}"  type="video/mp4">





      //     <p class="vjs-no-js">
      //       To view this video please enable JavaScript, and consider upgrading to a
      //       web browser that
      //       <a href="https://videojs.com/html5-video-support/" target="_blank"
      //         >supports HTML5 video</a
      //       >
      //     </p>
      //   </video>`


      let newTitle = document.createElement('h2');
      newTitle.innerText = `${episode.title}`

      // let newProductButton = document.createElement('button');
      // newProductButton.innerHTML = `Voir cette chaine`

      // let newUrl = document.createElement('h3');
      // newUrl.innerHTML = `${episode.url}`

      // let newParagraph = document.createElement('p');
      // newParagraph.innerText = `${episode.title} - chaine : ${episode.channel}


      // ${episode.duration} minutes
      // ${episode.hasBeenWatched ? 'Already been watched' : 'Not yet watched'}`;


      newDiv.append(newTitle);
      // newDiv.append(newUrl);
      // newDiv.append(newParagraph);
      // newDiv.append(myVideo);

      // newDiv.append(newProductButton);
      box.append(newDiv);


      //Passing this object as the argument to a onclick function
      newDiv.addEventListener("click", function () {
        parseplayer();
      });


      function parseplayer() {


        let montitre = document.querySelector("#titretv");
        montitre.innerText = `${episode.title}`

        var myPlayer = videojs('#my-video');
        myPlayer.autoplay(true);
        myPlayer.loop(true);
        myPlayer.fluid(true);

        myPlayer.src(`${episode.url}`);






        //passer toutes les fonctions play/fermer.... lors de la création de la fonction parseplayer (creation du lecteur)

        //fonction pleine écran


        myPlayer.ready(function () {

          fullplayser.addEventListener("click", function () {
            fullplayer();
          });

          function fullplayer() {

            // `this` is the player in this context

            if (myPlayer.isFullscreen()) {
              myPlayer.exitFullscreen();
            } else {
              myPlayer.requestFullscreen();
            }
          };




          //pause
          pauseplayser.addEventListener("click", function () {
            attendreplayer();
          });

          function attendreplayer() {

            myPlayer.pause();

          };

          //play
          myPlayer.ready(function () {

            playplayser.addEventListener("click", function () {
              lectureplayer();
            });

            function lectureplayer() {

              myPlayer.play();


            };


            //close
            closeplayser.addEventListener("click", function () {
              fermerplayer();
            });

            function fermerplayer() {


              myPlayer.dispose();


            };













          });











        });













        // let myvid = document.querySelector("#my-video_html5_api");
        // console.log(myvid)
        // myvid.setAttribute("src",`${episode.url}`);
      };





    }



    body.append(box);





    const tabs = document.querySelectorAll('[data-tab-target]')
    const tabContents = document.querySelectorAll('[data-tab-content]')
    var myPlayer = videojs('#my-video');


    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const target = document.querySelector(tab.dataset.tabTarget)
        tabContents.forEach(tabContent => {
          tabContent.classList.remove('active')
        })
        tabs.forEach(tab => {
          tab.classList.remove('active')

        })
        tab.classList.add('active')
        target.classList.add('active')

      })
    })


  </script>








  <script>




// function loadXMLDoc() {
//   var xmlhttp = new XMLHttpRequest();
//   xmlhttp.onreadystatechange = function() {
//     if (this.readyState == 4 && this.status == 200) {
//       myFunction3(this);
//     }
//   };
//   xmlhttp.open("GET", "https://mirs-kha.github.io/landscape/epg.xml", true);
//   xmlhttp.send();
// }

// function myFunction3(xml) {
//   var x, i, xmlDoc, txt;
//   xmlDoc = xml.responseXML;
//   txt = "";
//   x = xmlDoc.getElementsByTagName("display-name");
//   for (i = 0; i< x.length; i++) {
//     txt += x[i].childNodes[0].nodeValue + "<br>";
//   }

//   document.getElementById("id01").innerHTML = txt;

//   console.log(txt)
// }





// const dinosaurs = import('/xml.json', {
//     assert: {
//         type: 'json'
//     }
// });

// dinosaurs.then( d => 
//         d.default.forEach(dino => {
//          console.log("🦕", dino);
//     })
//  );






// const https = require('https')
// const parser = require('iptv-playlist-parser')

// https
//   .get('http://127.0.0.1:5500/1tele.m3u', res => {
//     let data = []

//     res.on('data', chunk => {
//       data.push(chunk)
//     })

//     res.on('end', () => {
//       const playlist = Buffer.concat(data).toString()

//       const result = parser.parse(playlist)

//       console.log(result)
//     })
//   })
//   .on('error', err => {
//     console.error(err.message)
//   })


//   console.log('ok')








// fetch("xml.json")
// .then(reponse => reponse.json())
// .then(json=> output.innerHTML = JSON.stringify(json));
// console.log(json)





















//   </script>
// <button type="button" onclick="loadXMLDoc()">
//   Get my CD collection</button>
  

  <div id="output"> </div>

  <button type="button" onclick="manif()">
    Get my CD collection</button>
<header></header>
    <section></section>









  <script src="xml.js"></script>
  <script src="xml.json"  type="application/json"></script>

</body>

</html>
